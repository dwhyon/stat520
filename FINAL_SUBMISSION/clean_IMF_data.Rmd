```{r}
library(readxl)
library(dplyr)
library(tidyr)
```

```{r}
# Read the Excel file
file_path <- "data/raw/WEO_Data.xlsx"
data <- read_excel(file_path, col_types = "text")

# Replace "n/a" and blank cells with NA, and convert year columns to numeric
data_cleaned <- data %>%
  select(-Units, -Scale) %>%  
  mutate(across(everything(), ~ na_if(., "n/a"))) %>%  # Replace "n/a" with NA
  mutate(across(starts_with("20"), as.numeric))

# Pivot the data to make it wide
data_wide <- data_cleaned %>%
  pivot_longer(cols = starts_with("20"),
               names_to = "Year", 
               values_to = "Value") %>%
  pivot_wider(names_from = `Subject Descriptor`, 
              values_from = "Value")

# Export the cleaned data to a CSV file
write.csv(data_wide, file = "data/interim/IMF_data.csv", row.names = FALSE)
```

